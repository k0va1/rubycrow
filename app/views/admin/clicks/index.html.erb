<div class="mb-6 flex items-center justify-between">
  <div>
    <h1 class="admin-heading text-2xl font-semibold">Clicks</h1>
    <p class="admin-subtext mt-1 text-sm"><%= @pagy.count %> clicks total</p>
  </div>
</div>

<% if @clicks.any? %>
  <%= lui.table(data: @clicks) do |table| %>
    <% table.with_column("Clicked At") { |click| click.clicked_at.strftime("%b %d, %Y %H:%M") } %>
    <% table.with_column("Destination") { |click| link_to truncate(click.tracked_link.destination_url, length: 40), click.tracked_link.destination_url, target: "_blank", rel: "noopener noreferrer" } %>

    <% table.with_column("Subscriber") do |click| %>
      <% if click.subscriber %>
        <%= link_to click.subscriber.email, admin_subscriber_path(click.subscriber) %>
      <% else %>
        Anonymous
      <% end %>
    <% end %>

    <% table.with_column("Device") do |click| %>
      <%= lui.badge { click.device_type || "â€”" } %>
    <% end %>

    <% table.with_column("Unique") do |click| %>
      <% if click.unique_click? %>
        <%= lui.badge(status: :success) { "Yes" } %>
      <% else %>
        <%= lui.badge { "No" } %>
      <% end %>
    <% end %>

    <% table.with_action { |click| link_to "View", admin_click_path(click) } %>
    <% table.with_action { |click| link_to "Delete", admin_click_path(click), data: { turbo_method: :delete, turbo_confirm: "Delete this click?" } } %>
  <% end %>
  <%= render "admin/shared/pagination", pagy: @pagy %>
<% else %>
  <div class="admin-card py-12 text-center">
    <p class="admin-subtext text-sm">No clicks recorded yet</p>
  </div>
<% end %>

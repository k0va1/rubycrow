<div class="mb-8">
  <h1 class="admin-heading text-2xl font-semibold">Dashboard</h1>
  <p class="admin-subtext mt-1 text-sm">Overview of your newsletter</p>
</div>

<div class="mb-8 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4">
  <%= render "admin/dashboard/stat_card", label: "Subscribers", value: @active_subscribers, value_label: "active", total: @total_subscribers %>
  <%= render "admin/dashboard/stat_card", label: "Blogs", value: @active_blogs, value_label: "active", total: @total_blogs %>
  <%= render "admin/dashboard/stat_card", label: "Articles", value: @unprocessed_articles, value_label: "unprocessed", total: @total_articles %>
  <%= render "admin/dashboard/stat_card", label: "Gems", value: @unprocessed_ruby_gems, value_label: "unprocessed", total: @total_ruby_gems %>
  <%= render "admin/dashboard/stat_card", label: "GitHub Repos", value: @unprocessed_github_repos, value_label: "unprocessed", total: @total_github_repos %>
  <%= render "admin/dashboard/stat_card", label: "Reddit Posts", value: @unprocessed_reddit_posts, value_label: "unprocessed", total: @total_reddit_posts %>
  <%= render "admin/dashboard/stat_card", label: "Issues", value: @sent_issues, value_label: "sent", total: @total_issues %>
  <%= render "admin/dashboard/stat_card", label: "Clicks", value: @total_clicks, value_label: "total", total: @total_clicks %>
</div>

<div class="grid grid-cols-1 gap-8 lg:grid-cols-2">
  <div>
    <h2 class="admin-heading mb-4 text-lg font-semibold">Recent Issues</h2>

    <% if @recent_issues.any? %>
      <%= lui.table(data: @recent_issues) do |table| %>
        <% table.with_column("Issue #") { |issue| link_to "##{issue.issue_number}", admin_newsletter_issue_path(issue) } %>
        <% table.with_column("Subject") { |issue| truncate(issue.subject, length: 40) } %>
        <% table.with_column("Sent At") { |issue| issue.sent_at&.strftime("%b %d, %Y") || "—" } %>
        <% table.with_action { |issue| link_to "View", admin_newsletter_issue_path(issue) } %>
      <% end %>
    <% else %>
      <div class="admin-card py-8 text-center">
        <p class="admin-subtext text-sm">No issues yet</p>
      </div>
    <% end %>
  </div>

  <div>
    <h2 class="admin-heading mb-4 text-lg font-semibold">Recent Articles</h2>

    <% if @recent_articles.any? %>
      <%= lui.table(data: @recent_articles) do |table| %>
        <% table.with_column("Title") { |article| link_to truncate(article.title, length: 35), admin_article_path(article) } %>
        <% table.with_column("Blog") { |article| article.blog.name } %>
        <% table.with_column("Published") { |article| article.published_at&.strftime("%b %d, %Y") || "—" } %>
      <% end %>
    <% else %>
      <div class="admin-card py-8 text-center">
        <p class="admin-subtext text-sm">No articles yet</p>
      </div>
    <% end %>
  </div>
</div>
